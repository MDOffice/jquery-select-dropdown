!function(e){null==e.fn.selectD&&(e.fn.selectD=function(s){if("object"==typeof(s=s||{})){var n=this;return n.each(function(){var i=e.extend({wrap_class:"",text_class:"",text_active_class:"text_active_class",dropdown_icon:null,templateResult:function(e){return e.text},onChange:null},s);new t(e(this),n,i)}),this}throw new Error("Invalid arguments for SelectD: "+s)});var t=function(e,t,s){this.$element=e,this.$items=t,this.options=s,this.build(),this.renderLabel(),this.renderItems(),this._registerEvents(),e.addClass("selectD-hidden-accessible"),e.attr("aria-hidden","true")};t.prototype.build=function(){this.$element.hide(),this.$wrap=this.$element.wrap('<span class="selectD-wrap '+this.options.wrap_class+'">').parent(),this.options.dropdown_icon&&this.$wrap.append(this.options.dropdown_icon),this.$container=e('<span class="selectD-container">').appendTo(this.$wrap);var t=e('<span class="selectD-dropdown">');this.$container.append(t),this.$list=e('<ul class="selectD-results">').appendTo(t),this.parseOptions()},t.prototype.parseOptions=function(){var t=this;this.items=[],this.selected=[],this.$element.find("option").each(function(s,n){var i=e(n),o=i.val();t.items.push(s),t.items[s]={text:i.html().replace("&nbsp;"," ").trim(),value:o,element:n};var a=i.attr("data-width");a&&(t.items[s].width=a),i.is(":selected")&&(t.selected.push(o),t.selected[o]=t.items[s],t.options.onChange&&t.options.onChange(t.$element,t.$items,o))})},t.prototype.renderItems=function(){var t=this;this.$list.empty(),e.each(this.items,function(s,n){var i=e("<li>"+t.options.templateResult(n)+"</li>");t.selected.indexOf(n.value)>-1?i.addClass("highlighted"):i.removeClass("highlighted"),i.click(function(){t.clickItem(n)}),t.$list.append(i)})},t.prototype.renderLabel=function(){var e=this.selected[this.selected[0]],t=e.text;this.$wrap.attr("title",t),this.options.text_active_class&&(""!==t?this.$wrap.addClass(this.options.text_active_class):this.$wrap.removeClass(this.options.text_active_class)),e.width&&this.$wrap.parent().css({width:e.width+"mm"})},t.prototype._registerEvents=function(){var t=this;this.$element.on("open",function(){e(".selectD-container--open").removeClass("selectD-container--open"),t.$container.addClass("selectD-container--open"),t.renderItems()}),this.$element.on("close",function(){t.$container.removeClass("selectD-container--open"),t.$wrap.append(t.$container)}),this.$element.on("change",function(){t.renderLabel(),t.close()}),e("body").on("click",function(){t.close()}),t.$wrap.on("click",function(e){e.stopPropagation(),t.$container.hasClass("selectD-container--open")?t.close():t.open()}),t.$list.on("click",function(e){e.stopPropagation()})},t.prototype.clickItem=function(e){this.selected=[e.value],this.selected[e.value]=e,this.$element.val(e.value),this.options.onChange&&this.options.onChange(this.$element,this.$items,e.value),this.$element.trigger("change")},t.prototype.open=function(){this.$container.appendTo("body"),this.$container.find(".selectD-dropdown").css({width:"250px"}),this.$container.find(".selectD-dropdown").addClass("selectD-dropdown--below"),this.$container.addClass("selectD-container--open");var e=this.$wrap;this.$container.css({position:"absolute",top:e.offset().top+e.height(),left:e.offset().left}),this.$element.trigger("open",{})},t.prototype.close=function(){this.$element.trigger("close")}}(jQuery);